# 系统设置

## 功能概述

系统设置模块为管理员和普通用户提供了丰富的配置选项，包括个人信息设置、系统参数配置、菜单管理等功能。本章将详细介绍各项设置功能的使用方法和配置要点。

### 主要功能

1. **个人信息管理** - 用户头像、基本信息修改
2. **密码安全设置** - 密码修改、安全策略配置
3. **系统菜单管理** - 导航菜单配置、权限控制
4. **系统参数配置** - 状态管理、类型管理
5. **环境配置管理** - 开发环境与生产环境配置

### 使用权限

- **普通用户**：个人信息设置、密码修改
- **系统管理员**：所有配置功能
- **HR管理员**：用户信息相关设置
- **部门管理员**：部门内用户设置

## 个人设置

### 功能入口

**访问路径：** [首页] > [右上角用户名] > [个人面板]  
**URL地址：** `/panel`  
**所需权限：** 登录用户

### 个人信息管理

#### 基本信息修改

1. 点击右上角用户名，选择"个人面板"
2. 在个人信息页面点击"编辑"按钮
3. 修改相应字段信息并保存

**可修改字段：**
- 用户头像
- 真实姓名
- 性别信息
- 联系电话
- 电子邮箱
- 所属部门（管理员可修改）
- 职位信息（管理员可修改）

#### 头像上传功能

1. 点击头像区域的"更换头像"按钮
2. 选择本地图片文件
3. 预览确认后上传

**上传要求：**
- **支持格式**：JPEG、JPG、PNG、GIF
- **文件大小**：≤ 2MB
- **推荐尺寸**：200x200像素
- **存储路径**：`/image/**`

### 密码修改

#### 安全要求

- **密码长度**：6-20位字符
- **组合要求**：必须包含字母和数字
- **安全限制**：不能与用户名相同
- **历史限制**：不能与最近3次使用的密码重复

#### 修改步骤

1. 进入个人面板页面
2. 点击"修改密码"按钮
3. 输入当前密码进行身份验证
4. 输入新密码并确认
5. 提交修改并重新登录

**表单信息：**
```
当前密码：[必填] 用于身份验证
新密码：[必填] 6-20位字符
确认密码：[必填] 需与新密码一致
```

## 系统参数配置

### 菜单管理

#### 功能概述

系统管理员可通过菜单管理功能对系统导航菜单进行配置，包括菜单的添加、编辑、删除和排序。

**访问路径：** [系统管理] > [菜单管理]  
**URL地址：** `/menutable` `/menuedit`  
**所需权限：** 系统管理员

#### 菜单配置

**菜单属性设置：**

| 字段名 | 描述 | 类型 | 必填 | 说明 |
|--------|------|------|------|------|
| menuId | 菜单ID | Long | 是 | 系统自动生成 |
| menuName | 菜单名称 | String | 是 | 导航栏显示文字 |
| menuUrl | 菜单链接 | String | 是 | 点击跳转URL |
| menuIcon | 菜单图标 | String | 否 | Bootstrap图标类名 |
| menuGrade | 权限分数 | Integer | 是 | 访问权限等级 |
| sortId | 排序号 | Integer | 是 | 显示顺序 |
| parentId | 父菜单ID | Integer | 否 | 上级菜单，0为顶级 |
| show | 显示状态 | Boolean | 是 | 是否在导航中显示 |

#### 菜单管理操作

**1. 添加新菜单**
- 访问：`/menuedit`
- 填写菜单基本信息
- 设置父菜单关系
- 配置权限等级和排序

**2. 编辑现有菜单**
- 访问：`/menuedit?id={menuId}`
- 修改菜单属性
- 更新排序或权限设置

**3. 菜单排序调整**
- URL：`/changeSortId`
- 方法：POST
- 参数：menuId, newSortId

**4. 删除菜单**
- URL：`/deletethis`
- 方法：POST
- 注意：删除前检查子菜单

#### 菜单层级结构

**支持层级：**
- 最大支持3级菜单结构
- 顶级菜单：parentId = 0
- 二级菜单：parentId = 顶级菜单ID
- 三级菜单：parentId = 二级菜单ID

**层级示例：**
```
系统管理 (parentId=0)
├── 用户管理 (parentId=系统管理ID)
│   ├── 用户列表 (parentId=用户管理ID)
│   └── 用户权限 (parentId=用户管理ID)
└── 系统设置 (parentId=系统管理ID)
    ├── 菜单管理 (parentId=系统设置ID)
    └── 参数配置 (parentId=系统设置ID)
```

### 状态管理

#### 系统状态配置

**访问路径：** [系统管理] > [状态管理]  
**URL地址：** `/statustable` `/statusedit`  
**功能说明：** 管理系统中各种状态值的定义

**主要功能：**
- 查看状态列表：`/statustable`
- 编辑状态信息：`/statusedit`
- 删除状态记录：`/deletestatus`
- 状态有效性检查：`/statuscheck`

### 类型管理

#### 系统类型配置

**访问路径：** [系统管理] > [类型管理]  
**URL地址：** `/typetable` `/typeedit`  
**功能说明：** 管理系统中各种分类类型的定义

**主要功能：**
- 查看类型列表：`/typetable`
- 编辑类型信息：`/typeedit`
- 删除类型记录：`/deletetype`
- 类型有效性检查：`/typecheck`

## 权限配置

### 角色权限集成

系统设置与角色管理模块紧密集成：

1. **菜单权限设置**
   - 为不同角色分配菜单访问权限
   - 通过menuGrade字段控制权限等级
   - 支持细粒度的功能点权限控制

2. **用户权限继承**
   - 用户权限从所属角色继承
   - 支持多角色权限合并
   - 管理员具有最高权限

### 权限验证机制

**前端权限控制：**
- 菜单显示基于用户权限动态渲染
- 无权限菜单项自动隐藏
- 支持角色权限的实时更新

**后端权限控制：**
- 所有系统设置功能需要管理员权限
- URL访问权限通过拦截器验证
- 数据操作权限在业务层校验

## 最佳实践

### 菜单配置建议

1. **层级设计原则**
   - 控制菜单层级不超过3级
   - 保持同级菜单数量适中（≤10个）
   - 使用语义化的菜单名称

2. **权限设置规范**
   - 权限分数设置要有层次性
   - 重要功能设置较高权限等级
   - 定期审查权限配置的合理性

3. **图标选择建议**
   - 使用Bootstrap内置图标
   - 保持图标风格统一
   - 选择与功能相关的直观图标

### 系统参数优化

1. **性能优化**
   - 根据服务器资源调整Tomcat参数
   - 合理设置文件上传大小限制
   - 启用适当的缓存策略

2. **安全配置**
   - 生产环境关闭调试模式
   - 使用强密码策略
   - 定期更新系统配置

3. **监控建议**
   - 定期检查系统日志
   - 监控文件上传目录空间
   - 关注数据库连接池状态

## 故障排除

### 常见配置问题

1. **菜单显示异常**
   - 检查menuGrade权限设置
   - 确认show字段为true
   - 验证parentId关系正确

2. **文件上传失败**
   - 检查文件路径权限
   - 确认文件大小限制设置
   - 验证目录存在且可写

3. **权限访问被拒绝**
   - 确认用户角色配置
   - 检查菜单权限分数设置
   - 验证角色权限列表完整性

### 配置文件问题

**开发环境常见问题：**
- 数据库连接配置错误
- 文件路径不存在或无权限
- MyBatis映射文件路径错误

**生产环境常见问题：**
- 环境变量未正确设置
- Docker容器资源限制
- 静态资源路径配置错误
